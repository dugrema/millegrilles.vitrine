(this["webpackJsonpfront-end"]=this["webpackJsonpfront-end"]||[]).push([[0],{132:function(e,t){},255:function(e,t,n){},302:function(e,t){},304:function(e,t){},314:function(e,t){},316:function(e,t){},342:function(e,t){},344:function(e,t){},345:function(e,t){},350:function(e,t){},352:function(e,t){},358:function(e,t){},360:function(e,t){},379:function(e,t){},391:function(e,t){},394:function(e,t){},446:function(e,t,n){},448:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(0),i=n.n(o),a=n(63),c=n.n(a),s=(n(252),n(253),n(21)),u=n(25),l=n.n(u),j=n(64),h=n(12),f=n(13),p=n(16),d=n(15),b=(n(255),n(236)),g=n.n(b),O=n(38),m=n.n(O),v=n(39),x=n(135),P=n(137),y=n(237),k=n(239),C=n(41),S=n(75),_=n.n(S);n(416);P.a.use(y.a).use(k.a).use(C.e).init({fallbackLng:"fr",keySeparator:".",backend:{loadPath:"/vitrine/locales/{{lng}}/{{ns}}.json"},interpolation:{escapeValue:!1,format:function(e,t,n){return e instanceof Date?_()(e).locale(n).format(t):isNaN(e)||isNaN(t)?e:Number(e).toFixed(t)}}});P.a;var w=n(457);function I(e){var t=e.rootProps.language;return e.contenu[t]||""}var M=n(242),D=n.n(M),N=n(460),F=n(450),A=n(451),T=n(98),L=n.n(T),E=function(){function e(){Object(h.a)(this,e),this.date_default="YYYY/MM/DD",this.datetime_default="YYYY/MM/DD HH:mm:ss",this.datemonthhour_default="MMM-DD HH:mm:ss",this.timezone_default="America/Toronto"}return Object(f.a)(e,[{key:"format_date",value:function(e){return L()(1e3*e).tz(this.timezone_default).format(this.date_default)}},{key:"format_datetime",value:function(e){return L()(1e3*e).tz(this.timezone_default).format(this.datetime_default)}},{key:"format_monthhour",value:function(e){return L()(1e3*e).tz(this.timezone_default).format(this.datemonthhour_default)}}]),e}(),z=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(h.a)(this,n),(e=t.call(this)).kb=1024,e.mb=1024*e.kb,e.gb=1024*e.mb,e.tb=1024*e.gb,e.precision=3,e}return Object(f.a)(n,[{key:"format",value:function(e){var t,n;return e>this.tb?(t=(e/this.tb).toPrecision(this.precision),n="Tb"):e>this.gb?(t=(e/this.gb).toPrecision(this.precision),n="Gb"):e>this.mb?(t=(e/this.mb).toPrecision(this.precision),n="Mb"):e>this.kb?(t=(e/this.kb).toPrecision(this.precision),n="kb"):(t=e,n="bytes"),t+" "+n}},{key:"render",value:function(){var e=this.props.nb;return Object(r.jsx)("span",{className:"filesize",children:this.format(e)})}}]),n}(i.a.Component),H=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(f.a)(n,[{key:"renderDernierChangement",value:function(){var e=this.props.date;if(!e||""===e)return Object(r.jsx)("span",{title:""});var t,n,o=new E,i=Math.floor(Date.now()/1e3),a=o.format_datetime(e),c=i-e;return(c=Math.floor(c/60))<60?(c=Math.max(0,c),t=Object(r.jsxs)("span",{title:a,children:[c," minutes"]})):c<1440?((c=Math.floor(c/60))>1&&(n="s"),t=Object(r.jsxs)("span",{title:a,children:[c," heure",n]})):c<43200?((c=Math.floor(c/1440))>1&&(n="s"),t=Object(r.jsxs)("span",{title:a,children:[c," jour",n]})):c<525600?(c=Math.floor(c/43200),t=Object(r.jsxs)("span",{title:a,children:[c," mois"]})):((c=Math.floor(c/525600))>1&&(n="s"),t=Object(r.jsxs)("span",{title:a,children:[c," annee",n]})),t}},{key:"render",value:function(){return Object(r.jsx)("span",{className:"date",children:this.renderDernierChangement()})}}]),n}(i.a.Component),Y=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(f.a)(n,[{key:"render",value:function(){var e=this.props.date;if(!e||""===e)return Object(r.jsx)("span",{title:""});var t=(new E).format_datetime(e);return Object(r.jsx)("span",{className:"date",children:t})}}]),n}(i.a.Component),B=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(h.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={err:"",detailPost:""},e.eventMajPost=function(t){var n=e.props.post_id,r=t.liste_posts.filter((function(e){return e.post_id===n}));if(1===r.length){var o=r[0],i=e.props.rootProps.certificateStore;Object(v.verifierSignatureMessage)(o,t._certificat,i)&&e.setState({detailPost:o})}},e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=this,t=this.props.post_id,n="/vitrine/posts/"+(t.substring(0,2)+"/")+t+".json";m.a.get(n).then((function(t){var n=t.data,r=e.props.rootProps.certificateStore;if(!Object(v.verifierSignatureMessage)(n,n._certificat,r))throw new Error("Signature invalide");e.setState({detailPost:n})})).catch((function(n){console.error("Erreur chargement post : %O",n),e.setState({err:"Post invalide "+t+" : "+n})})),this.props.rootProps.socket.on("majPost",this.eventMajPost)}},{key:"componentWillUnmount",value:function(){this.props.rootProps.socket.off("majPost",this.eventMajPost)}},{key:"render",value:function(){if(this.state.err)return Object(r.jsx)(N.a,{variant:"warning",children:this.state.err});var e=this.state.detailPost;if(!e)return Object(r.jsx)("p",{});var t=this.props.rootProps.language,n=e.html[t];if(!n&&(t=this.props.rootProps.siteConfiguration.languages[0],!(n=e.html[t])))return Object(r.jsx)("p",{children:" ... NO POST / PAS DE CONTENU ... "});var o=D()(n);if(this.props.afficherDate){var i=e["en-tete"].estampille;return Object(r.jsxs)(F.a,{children:[Object(r.jsxs)(A.a,{md:2,children:[Object(r.jsx)(H,{date:i}),Object(r.jsx)("div",{children:Object(r.jsx)(Y,{date:i})})]}),Object(r.jsx)(A.a,{children:o})]})}return o}}]),n}(i.a.Component),W=n(461),J=n(452);function V(e){var t=e.cards,n="";return t&&(n=t.map((function(t,n){var o="",i="";return t.image_url&&(o=Object(r.jsx)(W.a.Img,{variant:"top",src:t.image_url})),t.titre&&(i=Object(r.jsx)(W.a.Title,{children:t.titre})),t.sous_titre&&(i=Object(r.jsx)(W.a.Title,{children:t.sous_titre})),Object(r.jsxs)(W.a,{style:{width:"18rem"},children:[o,Object(r.jsxs)(W.a.Body,{children:[i,Object(r.jsx)(B,{rootProps:e.rootProps,post_id:t.post_id},t.post_id)]})]},n)}))),Object(r.jsx)(r.Fragment,{children:Object(r.jsx)(J.a,{children:n})})}var K=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(f.a)(n,[{key:"render",value:function(){var e=this.props.rootProps;return e.siteConfiguration.accueil.map((function(t,n){return Object(r.jsx)(U,{rootProps:e,rangee:t},n)}))}}]),n}(i.a.Component);function G(e){var t=e.rootProps;t.siteConfiguration,e.section;return e.section.posts.map((function(e,n){return Object(r.jsx)(U,{rootProps:t,rangee:e,afficherDate:!0},n)}))}function U(e){var t=e.rangee;return"CardDeck"===t.layout?Object(r.jsx)(V,Object(s.a)({rootProps:e.rootProps},e.rangee)):t.post_id?Object(r.jsx)(B,Object(s.a)(Object(s.a)({rootProps:e.rootProps},e.rangee),{},{afficherDate:e.afficherDate})):void 0}var $=n(454),q=n(453),Q=n(458),R=n(459),X=n(245);function Z(e){var t=Object(X.a)(),n=t.t,o=(t.i18n,e.rootProps),i="",a="";if(o.siteConfiguration){o.language&&o.siteConfiguration.titre&&(i=o.siteConfiguration.titre[o.language]);var c=o.siteConfiguration.languages;c&&c.length>1&&(a=Object(r.jsx)(Q.a.Link,{onClick:e.rootProps.changerLanguage,children:n("menu.changerLangue")}))}return Object(r.jsxs)(R.a,{collapseOnSelect:!0,expand:"md",bg:"info",variant:"dark",fixed:"top",children:[Object(r.jsx)(R.a.Brand,{href:"/vitrine",children:i}),Object(r.jsx)(R.a.Toggle,{"aria-controls":"responsive-navbar-menu"}),Object(r.jsxs)(R.a.Collapse,{id:"responsive-navbar-menu",children:[Object(r.jsx)(ee,{changerPage:e.changerPage,rootProps:e.rootProps}),Object(r.jsx)(Q.a,{className:"justify-content-end",children:a})]})]})}var ee=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(h.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).changerPage=function(t){var n={value:t};e.props.changerPage({currentTarget:n})},e}return Object(f.a)(n,[{key:"render",value:function(){var e=this,t=this.props.rootProps.siteConfiguration,n=(this.props.language,"");return t.sections&&(n=t.sections.map((function(t,n){return Object(r.jsx)(te,{section:t,sectionIdx:n,rootProps:e.props.rootProps},n)}))),Object(r.jsxs)(Q.a,{className:"mr-auto",activeKey:this.props.section,onSelect:this.changerPage,children:[Object(r.jsx)(Q.a.Item,{children:Object(r.jsxs)(Q.a.Link,{eventKey:"SiteAccueil",children:[Object(r.jsx)("i",{className:"fa fa-home"})," ",Object(r.jsx)(q.a,{children:"menu.Accueil"})]})}),n]})}}]),n}(i.a.Component);function te(e){return Object(r.jsx)(Q.a.Item,{children:Object(r.jsx)(Q.a.Link,{eventKey:"section:"+e.sectionIdx,children:Object(r.jsx)(I,{rootProps:e.rootProps,contenu:e.section.entete})})})}n(446);var ne=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(f.a)(n,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){return Object(r.jsxs)("div",{className:"flex-wrapper",children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(re,{changerPage:this.props.changerPage,rootProps:this.props.rootProps}),Object(r.jsx)(oe,{page:this.props.page})]}),Object(r.jsx)(ie,{rootProps:this.props.rootProps})]})}}]),n}(i.a.Component);function re(e){return Object(r.jsxs)($.a,{children:[Object(r.jsx)(Z,{changerPage:e.changerPage,rootProps:e.rootProps}),Object(r.jsx)("div",{className:"body-top-padding"})]})}function oe(e){return Object(r.jsx)($.a,{children:e.page})}function ie(e){var t=e.rootProps.idmg;e.rootProps.idmg;var n="";return e.rootProps&&e.rootProps.manifest&&(n=e.rootProps.manifest),Object(r.jsx)($.a,{fluid:!0,className:"footer bg-info",children:Object(r.jsxs)(F.a,{children:[Object(r.jsx)(A.a,{sm:2,className:"footer-left"}),Object(r.jsx)(A.a,{sm:8,className:"footer-center",children:Object(r.jsxs)("div",{className:"millegrille-footer",children:[Object(r.jsxs)("div",{children:["IDMG : ",t]}),Object(r.jsxs)("div",{children:[Object(r.jsx)(q.a,{children:"layout.coupdoeilAdvert"})," ",Object(r.jsx)("span",{title:n.date,children:Object(r.jsx)(q.a,{values:{version:n.version},children:"layout.coupdoeilVersion"})})]})]})}),Object(r.jsx)(A.a,{sm:2,className:"footer-right",children:null})]})})}var ae=n(455),ce=n(456);function se(e){return"fichiers"===e.section.type?Object(r.jsx)(ue,Object(s.a)({},e)):"album"===e.section.type?Object(r.jsx)(le,Object(s.a)({},e)):"blogposts"===e.section.type?Object(r.jsx)(me,Object(s.a)({},e)):"Section inconnue : "+e.type}var ue=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(h.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={collections:"",collectionId:""},e.setCollectionId=function(t){var n=t.currentTarget.value;e.setState({collectionId:n})},e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=this;ve(this.props.section,this.props.rootProps).then((function(t){e.setState({collections:t})}))}},{key:"render",value:function(){var e=this.props.section;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h1",{children:Object(r.jsx)(I,{rootProps:this.props.rootProps,contenu:e.entete})}),Object(r.jsx)(je,{rootProps:this.props.rootProps,collections:this.state.collections})]})}}]),n}(i.a.Component),le=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(h.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={collections:"",collectionId:"",imageFuuid:""},e.setCollectionId=function(t){var n=t.currentTarget.value||t.currentTarget.dataset.uuid;console.debug("Set collection ID : %s",n),e.setState({collectionId:n})},e.setImageFuuid=function(t){var n=t.currentTarget.value||t.currentTarget.dataset.fuuid;console.debug("Set image fuuid : %s",n),e.setState({imageFuuid:n})},e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){var e=this;ve(this.props.section,this.props.rootProps).then((function(t){e.setState({collections:t})}))}},{key:"render",value:function(){var e=this,t=this.props.section,n="";if(this.state.imageFuuid)n=Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(ae.a,{onClick:this.setImageFuuid,children:Object(r.jsx)(q.a,{children:"global.retour"})}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{})]}),Object(r.jsx)(Oe,{rootProps:this.props.rootProps,fuuid:this.state.imageFuuid})]});else if(this.state.collectionId){var o=this.state.collections.filter((function(t){return t.uuid===e.state.collectionId}));n=Object(r.jsxs)(r.Fragment,{children:[Object(r.jsxs)("div",{children:[Object(r.jsx)(ae.a,{onClick:this.setCollectionId,children:Object(r.jsx)(q.a,{children:"global.retour"})}),Object(r.jsx)("br",{}),Object(r.jsx)("br",{})]}),Object(r.jsx)(be,{rootProps:this.props.rootProps,collection:o[0],setCollectionId:this.setCollectionId,setImageFuuid:this.setImageFuuid})]})}else n=Object(r.jsx)(pe,{rootProps:this.props.rootProps,collections:this.state.collections,setCollectionId:this.setCollectionId});return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h1",{children:Object(r.jsx)(I,{rootProps:this.props.rootProps,contenu:t.entete})}),n]})}}]),n}(i.a.Component);function je(e){var t=e.collections;return t?(t.sort((function(e,t){var n=e.nom_collection,r=t.nom_collection;return n.localeCompare(r)})),e.collections.map((function(t,n){return Object(r.jsx)(he,{rootProps:e.rootProps,collection:t},n)}))):""}function he(e){var t=e.collection,n=t.fichiers.filter((function(e){return e.nom_fichier}));n.sort((function(e,t){var n=e.nom_fichier,r=t.nom_fichier;return n.localeCompare(r)}));var o=n.map((function(t){return Object(r.jsx)(fe,{rootProps:e.rootProps,fichier:t},t.uuid)}));return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h2",{children:t.nom_collection}),o]})}function fe(e){var t=e.fichier,n="/fichiers/"+t.fuuid;return Object(r.jsxs)(F.a,{children:[Object(r.jsx)(A.a,{md:0,lg:1}),Object(r.jsx)(A.a,{sm:12,lg:6,children:Object(r.jsx)("a",{href:n,children:t.nom_fichier})}),Object(r.jsx)(A.a,{sm:5,lg:2,className:"col-filesize",children:Object(r.jsx)(z,{nb:t.taille})}),Object(r.jsx)(A.a,{sm:7,lg:3,children:Object(r.jsx)(Y,{date:t.date_version})})]})}function pe(e){var t=e.collections;if(t){t.sort((function(e,t){var n=e.nom_collection,r=t.nom_collection;return n.localeCompare(r)}));var n=e.collections.map((function(t,n){return Object(r.jsx)(de,{rootProps:e.rootProps,collection:t,setCollectionId:e.setCollectionId},n)}));return Object(r.jsx)(ce.a,{children:n})}return""}function de(e){var t=e.collection,n=t.fichiers.filter((function(e){return e.mimetype&&e.mimetype.startsWith("image/")}));console.debug("Collection %O\nImages dans la collection : %O",t,n);var o=t.fuuid_preview;return!o&&n&&n.length>0&&(o=n[0].fuuid),Object(r.jsxs)(W.a,{border:"secondary",onClick:e.setCollectionId,"data-uuid":t.uuid,children:[Object(r.jsx)(W.a.Img,{variant:"top",src:"/fichiers/"+o+"?preview=1"}),Object(r.jsx)(W.a.Body,{children:Object(r.jsx)(W.a.Title,{children:t.nom_collection})})]})}function be(e){var t=e.collection,n=t.fichiers.filter((function(e){return e.mimetype&&e.mimetype.startsWith("image/")}));if(n.sort((function(e,t){var n=e.nom_fichier,r=t.nom_fichier;return n.localeCompare(r)})),console.debug("Collection %O\nImages dans la collection : %O",t,n),n){var o=n.map((function(t,n){return Object(r.jsx)(ge,{rootProps:e.rootProps,fichier:t,setImageFuuid:e.setImageFuuid},n)}));return Object(r.jsx)(ce.a,{children:o})}return""}function ge(e){var t=e.fichier,n=t.fuuid;return Object(r.jsxs)(W.a,{border:"secondary","data-fuuid":t.fuuid,onClick:e.setImageFuuid,children:[Object(r.jsx)(W.a.Img,{variant:"top",src:"/fichiers/"+n+"?preview=1"}),Object(r.jsx)(W.a.Body,{children:Object(r.jsx)(W.a.Title,{children:t.nom_fichier})})]})}function Oe(e){var t=e.fuuid;return Object(r.jsx)("img",{className:"image-fullsize",src:"/fichiers/"+t})}function me(e){console.debug("Props info : %O",e);var t=e.section;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("h2",{children:Object(r.jsx)(I,{contenu:t.entete,rootProps:e.rootProps})}),Object(r.jsx)(G,Object(s.a)({},e))]})}function ve(e,t){return xe.apply(this,arguments)}function xe(){return(xe=Object(j.a)(l.a.mark((function e(t,n){var r,o,i,a,c,s,u,j;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!0===t.toutes_collections,o=t.collections,!r){e.next=10;break}return e.next=4,m.a.get("/vitrine/listeCollections.json");case 4:if(i=e.sent,a=i.data,c=n.certificateStore,Object(v.verifierSignatureMessage)(a,a._certificat,c)){e.next=9;break}throw new Error("Signature invalide");case 9:o=i.data.liste_collections;case 10:return s=[],o.forEach((function(e){var t=e.substring(0,2);s.push(m.a.get("/vitrine/collections/"+t+"/"+e+".json"))})),e.next=14,Promise.all(s);case 14:return u=e.sent,j=u.map((function(e){return e.data})),e.abrupt("return",j);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Pe=n(99),ye=n.n(Pe),ke="/vitrine/socket.io",Ce={SiteAccueil:K},Se=function(e){Object(p.a)(n,e);var t=Object(d.a)(n);function n(){var e;Object(h.a)(this,n);for(var r=arguments.length,o=new Array(r),i=0;i<r;i++)o[i]=arguments[i];return(e=t.call.apply(t,[this].concat(o))).state={nomDomaine:"",siteConfiguration:"",language:"",certificateStore:"",idmg:"",infoVitrine:"",err:"",section:"",page:"SiteAccueil",socket:""},e.connecterSocketIo=function(){if(!e.state.connexionSocketIo){var t=g()("/",{path:ke,reconnection:!0,reconnectionAttempts:5,reconnectionDelay:500,reconnectionDelayMax:3e4,randomizationFactor:.5});t.on("disconnect",(function(){e.deconnexionSocketIo()})),t.on("majSite",e.eventMajSite),t.on("majCollection",e.eventMajCollection),e.setState({socket:t})}},e.eventMajSite=function(t){console.debug("MAJ site %O",t);var n=e.state.certificateStore;Object(v.verifierSignatureMessage)(t,t._certificat,n)&&e.setState({siteConfiguration:t})},e.eventMajCollection=function(e){console.debug("MAJ collection %O",e)},e.deconnexionSocketIo=function(){console.debug("Deconnexion Socket.IO")},e.changerPage=function(t){var n=t.currentTarget.value;if(n.startsWith("section:")){var r=Number(n.split(":")[1]),o=e.state.siteConfiguration.sections[r];e.setState({section:""},(function(t){e.setState({section:o})}))}else{if(!Ce[n])throw new Error("Page inconnue : "+n);e.setState({page:n,section:""})}},e.changerLanguage=function(t){var n=e.props.i18n,r=e.state.siteConfiguration,o=n.language,i="",a=r.languages.filter((function(e){return e!==o}));if(1!==a.length)throw new Error("Langue switch - plusieurs langues candidates, il faut choisir");i=a[0],document.title=r.titre[i],e.props.i18n.changeLanguage(i),e.setState({language:i})},e}return Object(f.a)(n,[{key:"componentDidMount",value:function(){console.debug("Vitrine version %s, %s",ye.a.version,ye.a.date),this.chargerSite(),this.chargerCertificateStore(),this.connecterSocketIo()}},{key:"chargerSite",value:function(){var e=Object(j.a)(l.a.mark((function e(){var t,n,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props.i18n.language,n=window.location.href.split("/")[2].split(":")[0],e.next=4,Me(n);case 4:r=e.sent,t?r.languages.includes(t)||(console.debug("Forcer changement de language, celui detecte dans le navigateur n'existe pas"),t=r.languages[0],this.props.i18n.changeLanguage(t)):(t=r.languages[0],this.props.i18n.changeLanguage(t)),document.title=r.titre[t],this.setState({nomDomaine:n,siteConfiguration:r,language:t});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"chargerCertificateStore",value:function(){var e=Object(j.a)(l.a.mark((function e(){var t,n,r,o,i,a,c,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=m.a.get("/vitrine/millegrille.pem"),n=m.a.get("/vitrine/info.json"),e.next=3,Promise.all([t,n]);case 3:if(r=e.sent,o=r[0].data,i=r[1].data,a=i.idmg,c=Object(x.calculerIdmg)(o),a===c){e.next=8;break}throw new Error("Idmg de vitrine sur info.json ne correspond pas a millegrille.pem");case 8:s=Object(v.preparerCertificateStore)(o),Object(v.verifierSignatureMessage)(i,i._certificat,s)?this.setState({idmg:a,certificateStore:s}):(console.error("Erreur verification info.json - signature invalide"),this.setState({err:"Erreur verification info.json - signature invalide"}));case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=Ie,t=Object(s.a)(Object(s.a)({},this.state),{},{changerLanguage:this.changerLanguage,manifest:ye.a}),n=Object(r.jsx)("p",{children:"Connexion en cours"});if(this.state.siteConfiguration&&this.state.certificateStore&&this.state.page)if(this.state.section)n=Object(r.jsx)(se,{section:this.state.section,rootProps:t});else{var o=Ce[this.state.page];n=Object(r.jsx)(o,{rootProps:t})}return Object(r.jsx)(e,{changerPage:this.changerPage,affichage:n,goHome:this.goHome,rootProps:t})}}]),n}(i.a.Component),_e=Object(w.a)()(Se);function we(e){return Object(r.jsx)(o.Suspense,{fallback:Object(r.jsx)("p",{children:"Loading"}),children:Object(r.jsx)(_e,{})})}function Ie(e){return Object(r.jsx)(ne,{changerPage:e.changerPage,page:e.affichage,goHome:e.goHome,sousMenuApplication:e.sousMenuApplication,rootProps:e.rootProps})}function Me(e,t){return De.apply(this,arguments)}function De(){return(De=Object(j.a)(l.a.mark((function e(t,n){var r,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r="/vitrine/sites/"+t+"/index.json",e.next=3,m()({method:"get",url:r});case 3:return o=e.sent,i=o.data,e.abrupt("return",i);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(Object(r.jsx)(we,{}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},99:function(e,t){e.exports={date:"2020-11-26 01:05",version:"1.35.0"}}},[[448,1,2]]]);
//# sourceMappingURL=main.40a58d74.chunk.js.map